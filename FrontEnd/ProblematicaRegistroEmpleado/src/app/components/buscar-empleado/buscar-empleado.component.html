<div class="flex min-h-screen">
  <!-- Barra de navegación -->
  <app-rh-navegacion class="w-64 flex-shrink-0"></app-rh-navegacion>
  <!-- Contenido principal -->
  <div class="flex-1 p-6 bg-gray-50">
    <div class="min-h-screen flex items-center justify-center bg-gray-100">
      <div class="w-full max-w-3xl bg-white p-8 rounded-lg shadow-md">
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">Buscar Empleado</h2>

        <!-- Barra de Búsqueda -->
        <div class="flex flex-col gap-4 mb-6">
          <div class="flex gap-4">
            <input
              type="text"
              id="searchTerm"
              placeholder="Buscar por Clave, Nombre, Apellido o RFC"
              [(ngModel)]="terminoBusqueda"
              (input)="buscarEmpleados()"
              class="flex-1 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
          </div>

          <!-- Mensaje de error -->
          <div *ngIf="mensajeError" class="text-red-500 text-sm">
            {{ mensajeError }}
          </div>

          <!-- Indicador de carga -->
          <div *ngIf="cargando" class="flex justify-center">
            <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div>
          </div>
        </div>

        <!-- Resultados de Búsqueda -->
        <div *ngIf="empleadosFiltrados.length > 0" class="overflow-x-auto">
          <table class="w-full text-sm text-left text-gray-500">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3">Clave</th>
                <th scope="col" class="px-6 py-3">Nombre</th>
                <th scope="col" class="px-6 py-3">RFC</th>
                <th scope="col" class="px-6 py-3">Departamento</th>
                <th scope="col" class="px-6 py-3">Puesto</th>
                <th scope="col" class="px-6 py-3">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let empleado of empleadosFiltrados" class="bg-white border-b hover:bg-gray-50">
                <td class="px-6 py-4">{{ empleado.claveEmpleado }}</td>
                <td class="px-6 py-4">
                  {{ empleado.nombreCompleto?.nombre }} {{ empleado.nombreCompleto?.apellidoPaterno }} {{ empleado.nombreCompleto?.apellidoMaterno }}
                </td>
                <td class="px-6 py-4">{{ empleado.RFC }}</td>
                <td class="px-6 py-4">{{ empleado.departamento }}</td>
                <td class="px-6 py-4">{{ empleado.puesto }}</td>
                <td class="px-6 py-4 space-x-2">
                  <button
                    (click)="verDetalles(empleado.claveEmpleado)"
                    class="px-3 py-1 bg-green-500 text-white rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    Ver Detalles
                  </button>
                  <button
                    (click)="editarEmpleado(empleado.claveEmpleado)"
                    class="px-3 py-1 bg-yellow-500 text-black rounded-md hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-500"
                  >
                    Editar
                  </button>
                  <button
                    (click)="eliminarEmpleado(empleado.claveEmpleado)"
                    class="px-3 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500"
                  >
                    Eliminar
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Mensaje cuando no hay resultados -->
        <div *ngIf="empleadosFiltrados.length === 0 && !cargando" class="text-center text-gray-500 my-8">
          No se encontraron resultados. Intente con otra búsqueda.
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Detalles del Empleado -->
  <div *ngIf="mostrarModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
    <div class="bg-white w-full max-w-2xl p-6 rounded-lg shadow-md relative">
      <span (click)="cerrarModal()" class="absolute top-2 right-2 text-2xl cursor-pointer">&times;</span>
      <h3 class="text-xl font-bold text-gray-800 mb-4">Detalles del Empleado</h3>
      <div *ngIf="empleadoSeleccionado" class="space-y-2">
        <p><strong>Clave:</strong> {{ empleadoSeleccionado.claveEmpleado }}</p>
        <p><strong>Nombre:</strong> {{ empleadoSeleccionado.nombreCompleto?.nombre }} {{ empleadoSeleccionado.nombreCompleto?.apellidoPaterno }} {{ empleadoSeleccionado.nombreCompleto?.apellidoMaterno }}</p>
        <p><strong>RFC:</strong> {{ empleadoSeleccionado.RFC }}</p>
        <p><strong>Sexo:</strong> {{ empleadoSeleccionado.sexo }}</p>
        <p><strong>Fecha de Nacimiento:</strong> {{ empleadoSeleccionado.fechaNacimiento | date:'dd/MM/yyyy' }}</p>
        <p><strong>Departamento:</strong> {{ empleadoSeleccionado.departamento }}</p>
        <p><strong>Puesto:</strong> {{ empleadoSeleccionado.puesto }}</p>
        
        <div *ngIf="empleadoSeleccionado.domicilio">
          <p><strong>Domicilio:</strong></p>
          <p class="ml-4">
            {{ empleadoSeleccionado.domicilio.calle }} 
            {{ empleadoSeleccionado.domicilio.numeroExterior }}
            {{ empleadoSeleccionado.domicilio.numeroInterior ? ', Int. ' + empleadoSeleccionado.domicilio.numeroInterior : '' }},
            {{ empleadoSeleccionado.domicilio.colonia }}, 
            {{ empleadoSeleccionado.domicilio.ciudad }}, 
            CP: {{ empleadoSeleccionado.domicilio.codigoPostal }}
          </p>
        </div>
        
        <p><strong>Teléfonos:</strong> {{ empleadoSeleccionado.telefono?.join(', ') }}</p>
        <p><strong>Correos:</strong> {{ empleadoSeleccionado.correoElectronico?.join(', ') }}</p>
        
        <div *ngIf="empleadoSeleccionado.referencias && empleadoSeleccionado.referencias.length > 0">
          <p><strong>Referencias:</strong></p>
          <ul class="ml-4">
            <li *ngFor="let referencia of empleadoSeleccionado.referencias" class="mb-1">
              {{ referencia.nombreFamiliar }} ({{ referencia.parentesco }}) - 
              Tel: {{ referencia.telefonoFamiliar }}, 
              Correo: {{ referencia.correoElectronicoFamiliar }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>